<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<title>Barnsley Fern Visualizer</title>
</head>
<body style='overflow:hidden; margin:0; background-color:#000;'>

<script id='shader-fs' type='text/x-fragment_shader'>

precision lowp float;

uniform vec4 u_color;

void main() {
  gl_FragColor = u_color;
}

</script>

<script id='shader-vs' type='text/x-vertex_shader'>

attribute vec2 a_position;

uniform vec2 u_resolution;

void main() {

  // convert from pixels to 0...1
  vec2 clip_space = a_position / u_resolution;

  // scale
  clip_space *= u_resolution.y * 0.185;

  // translate to bottom centre
  clip_space.y -= 1.0;

  gl_Position = vec4(clip_space, 0.0, 1.0);
  //gl_PointSize = 1.0;
}

</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/gl-matrix/2.8.1/gl-matrix-min.js"></script>

<script type="module">
'set strict'

import {sWebGL} from './sWebGL.mjs'
import {BarnsleyFern} from './BarnsleyFern.mjs'

window.onload = function() {

  var swgl = new sWebGL()

  swgl.drawScene = function() {

    swgl.gl.clear(swgl.gl.COLOR_BUFFER_BIT)

    var fern = new BarnsleyFern()

    // Iterate through transformations, drawing each position
    fern.iterate(
      5000,
      function (position) {
        swgl.drawPixel(position)
      }
    )

  }

}

</script>

</body>
</html>
